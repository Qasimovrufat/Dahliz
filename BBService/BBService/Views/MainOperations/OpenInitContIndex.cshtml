@model BBService.Models.ViewHome
@{
    ViewBag.Title = "OpenInitContIndex";
    List<string> permitted = (List<string>)Session["permitted"];
}

<div id="OpenInitContIndex">
    <div class="contaiber-fluid">
        <div class="row filter">
            <div class="col-md-12">
                <form @Url.Action("OpenInitContIndex", "MainOperations") autocomplete="off"> 
                        <div class="form-row">
                            <div class="col-md-12">

                                @*NV Nömrəsi*@
                                <div class="searchItem">
                                    <label class="lableSelectBox">NV Nömrəsi :</label>
                                    <select class="form-control inputItem inputItemWith-3 selectpicker" name="VehicleId" data-live-search="true">
                                        <option value="null" selected>Seçin ...</option>
                                        @foreach (var item in Model.Vehicles)
                                        {
                                            <option @(Model.SearchModelInitCont.VehicleId == item.Id ? "selected" : "") value="@item.Id">@item.Number</option>
                                        }
                                    </select>
                                </div>

                                @*Xətt Nömrəsi*@
                                <div class="searchItem">
                                    <label class="lableSelectBox">Xətt :</label>
                                    <select class="form-control inputItem inputItemWith-3 selectpicker" name="RouteId" data-live-search="true">
                                        <option value="null" selected>Seçin ...</option>
                                        @foreach (var item in Model.Routes)
                                        {
                                            <option @(Model.SearchModelInitCont.RouteId == item.Id ? "selected" : "") value="@item.Id">@item.Number</option>
                                        }
                                    </select>
                                </div>

                                @*Sürücü - 1*@
                                <div class="searchItem">
                                    <label class="lableSelectBox">Sürücü-1 :</label>
                                    <select class="form-control inputItem inputItemWith-3 selectpicker" name="FirstDriverId" data-live-search="true">
                                        <option value="null" selected>Seçin ...</option>
                                        @foreach (var item in Model.Employees)
                                        {
                                            <option @(Model.SearchModelInitCont.FirstDriverId == item.Id ? "selected" : "") value="@item.Id">@item.EmployeeCode-@item.Surname @item.Name @item.FutherName</option>
                                        }
                                    </select>
                                </div>
                                
                                @*Çıxış mexaniki*@
                                <div class="searchItem">
                                    <label class="lableSelectBox">Çıxış Mexaniki :</label>
                                    <select class="form-control inputItem inputItemWith-3 selectpicker" name="LeavingRecMechId" data-live-search="true">
                                        <option value="null" selected>Seçin ...</option>
                                        @foreach (var item in Model.Employees)
                                        {
                                            <option @(Model.SearchModelInitCont.LeavingRecMechId == item.Id ? "selected" : "") value="@item.Id">@item.EmployeeCode-@item.Surname @item.Name @item.FutherName</option>
                                        }
                                    </select>
                                </div>

                                @*Çıxış baş mexaniki*@
                                <div class="searchItem">
                                    <label class="lableSelectBox">Çıxış Baş Mexaniki :</label>
                                    <select class="form-control inputItem inputItemWith-3 selectpicker" name="LeavingSeniorRecMechId" data-live-search="true">
                                        <option value="null" selected>Seçin ...</option>
                                        @foreach (var item in Model.Employees)
                                        {
                                            <option @(Model.SearchModelInitCont.LeavingSeniorRecMechId == item.Id ? "selected" : "") value="@item.Id">@item.EmployeeCode-@item.Surname @item.Name @item.FutherName</option>
                                        }
                                    </select>
                                </div>

                                @*Çıxış tarixi*@
                                <div class="searchItem">
                                    <label>Çıxış tarixi(min) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveDateStart!=null?Model.SearchModelInitCont.LeaveDateStart:"")" class="form-control inputItem datepicker inputItemWith-2" name="LeaveDateStart" placeholder="Tarix seçin ...">
                                </div>

                                <div class="searchItem">
                                    <label>Çıxış tarixi(max) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveDateEnd!=null?Model.SearchModelInitCont.LeaveDateEnd:"")" class="form-control inputItem datepicker inputItemWith-2" name="LeaveDateEnd" placeholder="Tarix seçin ...">
                                </div>

                                @*Çıxış Saatı*@
                                <div class="searchItem">
                                    <label>Çıxış Saatı(min) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveHourStart!=null?Model.SearchModelInitCont.LeaveHourStart:"")" class="form-control inputItem timePicker inputItemWith-2" name="LeaveHourStart" placeholder="Saat seçin ...">
                                </div>

                                <div class="searchItem">
                                    <label>Çıxış Saatı(max) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveHourEnd!=null?Model.SearchModelInitCont.LeaveHourEnd:"")" class="form-control inputItem timePicker inputItemWith-2" name="LeaveHourEnd" placeholder="Saat seçin ...">
                                </div>

                                @*Çıxış km*@
                                <div class="searchItem">
                                    <label>Çıxış KM(min) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveKmMin!=null?Model.SearchModelInitCont.LeaveKmMin:"")" class="form-control inputItem inputItemWith-2" name="LeaveKmMin" placeholder="Daxil edin ...">
                                </div>

                                <div class="searchItem">
                                    <label>Çıxış KM(max) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveKmMax!=null?Model.SearchModelInitCont.LeaveKmMax:"")" class="form-control inputItem inputItemWith-2" name="LeaveKmMax" placeholder="Daxil edin ...">
                                </div>

                                @*Çıxış yanacaq*@
                                <div class="searchItem">
                                    <label>Çıxış yanacaq(min) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveFuelMin!=null?Model.SearchModelInitCont.LeaveFuelMin:"")" class="form-control inputItem inputItemWith-2" name="LeaveFuelMin" placeholder="Daxil edin ...">
                                </div>

                                <div class="searchItem">
                                    <label>Çıxış yanacaq(max) :</label>
                                    <input type="text" value="@(Model.SearchModelInitCont.LeaveFuelMax!=null?Model.SearchModelInitCont.LeaveFuelMax:"")" class="form-control inputItem inputItemWith-2" name="LeaveFuelMax" placeholder="Daxil edin ...">
                                </div>

                                <button type="submit" class="btn btn-primary">Axtar</button>
                            </div>
                        </div>
                    </form>                
            </div>
            <div class="col-md-12">
                <div class="nonFIlterWrapper">
                    <p class="nonFilter" id="clearFilter">
                        <a href=""><i class="fa fa-eraser"></i> Təmizlə</a>
                    </p>

                    <p class="nonFilter">
                        <a class="@(permitted.FirstOrDefault(a => a == "InitContCreate")==null? "hideAction" : "")" href="@Url.Action("InitContCreate","MainOperations")"><i class="fas fa-plus"></i> Yenisini yaradın</a>
                    </p>
                </div>
            </div>
        </div>
        <div class="row content">
            <div class="col-md-12">
                <table class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th scope="col" style="width: 50px;" class="centerCell">S/s</th>
                            <th style="width: 120px;" class="centerCell">Düzəliş et</th>
                            <th style="width: 80px;" class="centerCell">NV Nömrəsi</th>
                            <th style="width: 50px;" class="centerCell">Xətt</th>
                            <th style="width: 140px;" class="centerCell">Sürücü - 1</th>
                            <th style="width: 75px;" class="centerCell">Tarix</th>
                            <th style="width: 50px;" class="centerCell">Saat</th>
                            <th style="width: 140px;" class="centerCell">Mexanik</th>
                            <th style="width: 140px;" class="centerCell">Baş Mexanik</th>
                            <th style="width: 80px;" class="centerCell">Çıxış KM</th>
                            <th style="width: 80px;" class="centerCell">Çıxış Yanacaq</th>
                            <th style="width: 140px;" class="centerCell">Qeyd</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int i = 0;}
                        @foreach (var item in Model.InitialControlSchedule)
                        {
                            i++;
                        <tr class="pageItem">
                            <td scope="row" class="centerCell">@i</td>
                            <td class="centerCell">
                                <a class="@(permitted.FirstOrDefault(a => a == "InitContClose")==null? "hideAction" : "")" href="@Url.Action("InitContClose","MainOperations",new { id=item.Id})" title="Nəzarət kartını bağla"><i class="fa fa-list-alt" aria-hidden="true"></i></a>
                                <a class="@(permitted.FirstOrDefault(a => a == "InitContUpdate")==null? "hideAction" : "")" href="@Url.Action("InitContUpdate","MainOperations",new { id=item.Id})" title="Düzəliş et"><i class="fas fa-edit"></i></a>
                                <a class="@(permitted.FirstOrDefault(a => a == "InitContOpenDelete")==null? "hideAction" : "")" href="@Url.Action("InitContOpenDelete","MainOperations",new { id=item.Id})" onclick="return confirm('Are you sure?')" title="Sil"><i class="fas fa-times"></i></a>
                            </td>
                            <td class="centerCell">@(item.VehicleId == null ? "" : item.Vehicles.Number)</td>
                            <td class="centerCell">@(item.RouteId == null ? "" : item.Routes.Number)</td>
                            <td>@(item.FirstDriverId == null ? "" : (item.Employees4.Surname + " " + item.Employees4.Name + " " + item.Employees4.FutherName))</td>
                            <td class="centerCell">@(item.LeavingTime == null ? "" : item.LeavingTime.Value.ToString("dd.MM.yyyy"))</td>
                            <td class="centerCell">@(item.LeavingTime == null ? "" : item.LeavingTime.Value.ToString("HH:mm"))</td>
                            <td>@(item.LeavingRecMechId == null ? "" : (item.Employees.Surname + " " + item.Employees.Name + " " + item.Employees.FutherName))</td>
                            <td>@(item.LeavingSeniorRecMechId == null ? "" : (item.Employees1.Surname + " " + item.Employees1.Name + " " + item.Employees1.FutherName))</td>
                            <td class="centerCell">@(item.LeavingKilometer == null ? "" : item.LeavingKilometer.Value.ToString("#.##"))</td>
                            <td class="centerCell">@(item.LeavingFuel == null ? "" : item.LeavingFuel.Value.ToString("#.##"))</td>
                            <td class="centerCell">@(item.LeavingNote == null ? "" : item.LeavingNote)</td>
                        </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

        <div class="row footer">
            <div class="col-md-3 download">
                <div class="fieldSet">
                    <h1>Yüklə</h1>
                    <a href="@Url.Action("ExportOpenInitCont","MainOperations")" title="Excel">
                        <img src="~/public/assets/img/excel.png" alt="">
                    </a>
                </div>
            </div>
            <div class="col-md-6 paginationWrapper">
                <ul class="paginationCauseListNav"></ul>
            </div>
            <div class="col-md-3 records">
                <p>Cəmi @Model.InitialControlSchedule.Count() sətir</p>
            </div>
        </div>
    </div>
</div>
